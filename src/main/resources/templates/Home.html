<!DOCTYPE html>

<html th:lang="#{language_code}" xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/Head :: head">
    <title> Routine starter Home  </title>
    <meta name="description" content="Routine starter. Scheduling is the art of planning your activities so that you can achieve your goals and priorities in the time you have available.
Create your routines.">
    <meta name="keywords" content="Routine, Schedule, planning, organized, goals, achieve, create">
    <meta name="author" content="Limp-Biscuit">
</head>

<body>
<nav th:replace="fragments/Navigation :: navigation"></nav>


<button type="button" onclick="myFunction()">Show email</button>

<script>
    function myFunction() {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                console.log(this.responseText);
                var response = JSON.parse(this.responseText);
                for (var i = 0; i < response.length; i++ ) {
                    document.getElementById("email-" + response[i].id).innerHTML = response[i].email;
                    console.log(response[i])
                }

            }
        };
        xhttp.open("GET", "/api/routines");
        xhttp.send();
    }
</script>


<div class="container margin-tb">

    <button class="btn" th:classappend="${#execInfo.processedTemplateName == 'Create'} ? 'active' : ''">
        <a class="btn btn-danger btn-lg" href="/create">
            <em class="far fa-plus-square" th:text="#{createroutine}"></em>
        </a>
    </button>

    <table class="table">
        <thead>
        <tr class=" table-danger">
            <th> Title</th>
            <th> Text</th>
            <th> Color</th>
            <th> Done</th>
            <th> Date</th>
            <th> Email</th>
        </tr>
        </thead>
        <tbody>
        <tr class="table-danger" th:if="${routines.empty}">
            <td class="table-danger" colspan="2"> No routines yet</td>
        </tr>
        <tr class="table-danger" th:each="routine : ${routines}">
            <td class="table-danger"><span th:text="${routine.title}"></span></td>
            <td class="table-danger"><span th:text="${routine.text}"></span></td>
            <td class="table-danger"><span th:text="${routine.color}"></span></td>
            <td class="table-danger"><span th:text="${routine.done}"></span></td>
            <td class="table-danger"><span th:text="${routine.date}"></span></td>
            <td class="table-danger"><span th:id="'email-'+${routine.id}"> not loaded </span></td>
        </tr>
        </tbody>
    </table>
</div>


</body>
</html>